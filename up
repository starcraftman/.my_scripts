#!/usr/bin/env bash
GIT_REPOS=( ~/.bash-git-prompt ~/.zsh-git-prompt ~/.hhighlighter ~/.my_scripts )

SYS=generic
if hash apt-get 2>/dev/null; then
    SYS=debian
fi

if [ "xdebian" == "x$SYS" ]; then
    echo 'updating debian platform'
    sudo apt-get update && sudo apt-get -y dist-upgrade
    sudo apt-get autoremove
    sudo apt-get -f install
fi

if [ -d ~/.vim/bundle/Vundle.vim ]; then
    echo 'Updating vim plugins.'
    vim +PluginUpdate +qa
fi

echo 'updating git repos'
pushd .

DIR=~/.hg-prompt
if [ -d $DIR ]; then
    cd $DIR
    hg pull
fi

for dir in "${GIT_REPOS[@]}"; do
    if [ -d $dir ]; then
	cd $dir
	git pull
    fi
done

popd

# Force ag/ack update
if [ "xdebian" == "x$SYS" ] && [ -f $OPT/src/ack/README.md ]; then
    echo 'updating programs built from source'
    \rm -R -f $OPT
    SysInstall.py src > /dev/null 2>&1
fi
echo 'done'
